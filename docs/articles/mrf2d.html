<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A guide to mrf2d • mrf2d</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A guide to mrf2d">
<meta property="og:description" content="">
<meta property="og:image" content="https://freguglia.github.io/mrf2d/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mrf2d</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mrf2d.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Freguglia/mrf2d">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>A guide to mrf2d</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Freguglia/mrf2d/blob/master/vignettes/mrf2d.Rmd"><code>vignettes/mrf2d.Rmd</code></a></small>
      <div class="hidden name"><code>mrf2d.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(mrf2d)</a></code></pre></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<div id="a-general-introduction-to-markov-random-fields" class="section level2">
<h2 class="hasAnchor">
<a href="#a-general-introduction-to-markov-random-fields" class="anchor"></a>A general introduction to Markov Random Fields</h2>
<p>Markov Random Fields are probabilistic models used for modeling processes with local dependence. This dependence can be described by a graph <span class="math inline">\(\mathcal{G} = (\mathcal{V}, \mathcal{N})\)</span>, where <span class="math inline">\(\mathcal{V}\)</span> is a set of vertices and <span class="math inline">\(\mathcal{N}\)</span> a neighborhood system. A set of random variables <span class="math inline">\(\mathbf{Z} = \{Z_i, i \in \mathcal{V} \}\)</span> is called a Markov Random Field with respect to the neighborhood system <span class="math inline">\(\mathcal{N}\)</span> if</p>
<p><span class="math display">\[ P(Z_i = z_i | \{ Z_j, j \neq i \}) = P(Z_i| \{ Z_j, j \in \mathcal{N}_i \}), \]</span> where <span class="math inline">\(\mathcal{N}_i\)</span> denotes the neighbors of <span class="math inline">\(i\)</span> according to <span class="math inline">\(\mathcal{N}\)</span>.</p>
<p>If and only if the above equality holds for each <span class="math inline">\(i \in \mathcal{V}\)</span>, under some additional technical conditions, the joint distribution of <span class="math inline">\(\mathbf{Z}\)</span> is given by a Gibbs distribution of the form <span class="math display">\[ P(\mathbf{Z} = \mathbf{z}) = \frac{1}{\zeta} \exp \left( \sum_{q \in Q(\mathcal{N})} g_q(\mathbf z_q) \right),\]</span> where <span class="math inline">\(\mathcal{Q}(\mathcal{N})\)</span> denotes the set of cliques (fully connected subsets) of <span class="math inline">\(\mathcal{N}\)</span> and <span class="math inline">\(g_q\)</span> are arbitrary functions and <span class="math inline">\(\zeta\)</span> is a normalization constant (often called “partition function”).</p>
<p>While having a general form of probability measure for local dependent processes is a good start, specific cases with different choices of <span class="math inline">\(g_q\)</span>’s, <span class="math inline">\(\mathcal{V}\)</span> and <span class="math inline">\(\mathcal{N}\)</span> may lead to completely different models which statistical analysis should be carried differently. <code>mrf2d</code> provides tools for a specific, yet large, class models usually present in an image processing context: Two-dimensional lattices.</p>
</div>
<div id="a-spatially-stationary-mrf-model-for-2-dimensional-lattices" class="section level2">
<h2 class="hasAnchor">
<a href="#a-spatially-stationary-mrf-model-for-2-dimensional-lattices" class="anchor"></a>A spatially stationary MRF model for 2-dimensional lattices</h2>
<p>The model adopted in <code>mrf2d</code> has the following assumptions:</p>
<ul>
<li><p><span class="math inline">\(\mathcal{V} = \mathcal{L} = \{ i = (i_x, i_j): 1 \leq i_x \leq N; 1 \leq i_y \leq M \}\)</span>: The data points (called pixels) are indexed by a retangular lattice <span class="math inline">\(\mathcal{L}\)</span> of dimension <span class="math inline">\(N \times M\)</span>.</p></li>
<li><p><span class="math inline">\(\mathcal{N}\)</span> is determined by a set of relative positions <span class="math inline">\(\mathcal{R}\)</span>: There is an edge connecting two pixels <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> if and only if their relative position <span class="math inline">\((i_x, i_y) - (j_x, j_y)\)</span> is in <span class="math inline">\(\mathcal{R}\)</span>. As an example, if <span class="math inline">\(\mathcal{R} = \{ (1,0), (0,1) \}\)</span>, pixels are connected to their nearest neighbors horizontally and vertically, which can be represented by the structure below. Note the opposite directions have edges but they are not included in <span class="math inline">\(\mathcal{R}\)</span> to avoid redundancy.</p></li>
</ul>
<p><img src="mrf2d_files/figure-html/ex_mrfi-1.png" width="30%" style="display: block; margin: auto;"></p>
<p><span class="math display">\[ P_\theta(\mathbf{Z} = \mathbf{z}) = \frac{1}{\zeta_\theta} \exp \left( \sum_{i \in \mathcal{L}} \sum_{j = i + r}^{r \in \mathcal{R}} \theta_{z_i, z_j, r} \right) \]</span></p>
<p><span class="math display">\[ P_\theta(\mathbf{Z} = \mathbf{z}) = \frac{1}{\zeta_\theta} \exp \left( \sum_{r \in \mathcal{R}} \sum_{a,b = 0}^C \theta_{a,b,r} n_r(a,b) \right) \]</span> <span class="math inline">\(n_r(a,b) = \sum_{i \in \mathcal{L}} \mathbb{1}(z_i = a, z_{i+r} = b)\)</span></p>
</div>
<div id="the-mrf2d-package" class="section level2">
<h2 class="hasAnchor">
<a href="#the-mrf2d-package" class="anchor"></a>The <code>mrf2d</code> package</h2>
<p><code>mrf2d</code> has the goal to provide tools for analysis of Markov Random Fields on two-dimensional lattices, mainly, by defining a well-designed representation of the interaction structure, as well as parameters sets with different types of restrictions. It also exports efficient implementations of the most commom estimation methods and a sampling function, making it easy to implement new or specific algorithms with little effort taking advantage of the the package’s API.</p>
<p>Computational efficiency is also a feature of the package, having most of the high-cost core functions written with <code>Rcpp</code> backend and representations thoughtfully designed for high performance.</p>
<p>The package also provides <a href="https://freguglia.github.io/mrf2d/reference/dplot.html">plotting</a> functions <code><a href="../reference/dplot.html">dplot()</a></code> and <code><a href="../reference/dplot.html">cplot()</a></code> that automatically convert <code>matrix</code> objects to appropriate <code>data.frame</code> structures and creates <code>ggplot</code> objects from it. These functions aim to provide easy to use methods of visualization but also take advantage of <a href="https://ggplot2.tidyverse.org/"><code>ggplot2</code></a>’s grammar to modify aesthetics and create elegant and customizable visualizations of lattice data. <code><a href="../reference/dplot.html">dplot()</a></code> should be used for <strong>d</strong>iscrete data while <code><a href="../reference/dplot.html">cplot()</a></code> is suitable for <strong>c</strong>ontinuous data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span>(Z_potts)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; [1] "matrix"</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/vector">as.vector</a></span>(Z_potts))</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; [1] 0 1 2</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="kw"><a href="../reference/dplot.html">dplot</a></span>(Z_potts, <span class="dt">legend =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="mrf2d_files/figure-html/plots_examples-1.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="../reference/dplot.html">cplot</a></span>(Z_potts <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(Z_potts)))</a></code></pre></div>
<p><img src="mrf2d_files/figure-html/plots_examples-2.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="kw"><a href="../reference/dplot.html">dplot</a></span>(Z_potts) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Title added with ggplot2"</span>)</a></code></pre></div>
<p><img src="mrf2d_files/figure-html/plots_examples-3.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="../reference/dplot.html">dplot</a></span>(Z_potts) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span>(<span class="dt">type =</span> <span class="st">"qual"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Title added with ggplot2"</span>)</a></code></pre></div>
<p><img src="mrf2d_files/figure-html/plots_examples-4.png" width="50%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="the-mrfi-class-and-parameter-arrays" class="section level1">
<h1 class="hasAnchor">
<a href="#the-mrfi-class-and-parameter-arrays" class="anchor"></a>The <code>mrfi</code> class and parameter arrays</h1>
<p>The stationary Markov Random Fields described are completely specified by the set of relative positions where interactions exists <span class="math inline">\(\mathcal{R}\)</span> and the interaction parameters <span class="math inline">\(\theta_{a,b,r}\)</span>, <span class="math inline">\((a,b) \in \{0,\dots,C \}^2, r \in \mathcal{R}\)</span>.</p>
<p>In <code>mrf2d</code>, interaction structures <span class="math inline">\(\mathcal{R}\)</span> are represented by objects of the S4 class <code>mrfi</code>, while interaction parameters are reprensted by simple 3-dimensional arrays, where <code>theta[a,b,k]</code> contains the value of <span class="math inline">\(\theta_{a,b,r}\)</span> for the <span class="math inline">\(k\)</span>-th relative position. As an example, in a nearest-neighbor structure (<span class="math inline">\(|\mathcal{R}| = 2\)</span>) with <span class="math inline">\(C = 1\)</span>, where the interaction for equal values (<span class="math inline">\(a=b\)</span>) is <code>0</code> and <code>-0.99</code> for different values, the corresponding array would be</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">mrf2d<span class="op">:::</span><span class="kw">vec_to_array</span>(<span class="op">-</span><span class="fl">0.99</span>, <span class="st">"onepar"</span>, <span class="dv">1</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt;       0     1</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt; 0  0.00 -0.99</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; 1 -0.99  0.00</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt;       0     1</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; 0  0.00 -0.99</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; 1 -0.99  0.00</span></a></code></pre></div>
<p>Note how rows represents values <span class="math inline">\(a\)</span>, columns are values of <span class="math inline">\(b\)</span> and slices are the relative positions in <span class="math inline">\(\mathcal{R}\)</span>.</p>
<div id="creating-mrfi-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-mrfi-objects" class="anchor"></a>Creating <code>mrfi</code> objects</h2>
<p><code>mrfi</code> objects can be created with the <code><a href="../reference/mrfi.html">mrfi()</a></code> function. It takes three parameters: <code>max_norm</code>, <code>norm_type</code> and <code>positions</code>. <code>max_norm</code> and <code>norm_type</code> combined define a region where interactions are included. As example, if <code>max_norm</code> is <code>3</code> and <code>norm_type</code> is <code>"1"</code>, the interaction structure will include relative positions <span class="math inline">\(r\)</span> where <span class="math inline">\(|r_x| + |r_y| \leq 3\)</span>.</p>
<p>Note that opposite positions, e.g., <span class="math inline">\((1,0)\)</span> and <span class="math inline">\((-1,0)\)</span> are not both included, as the second one is always redundant for the model. A <code><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot()</a></code> method is available to visualize <code>mrfi</code> objects.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/mrfi.html">mrfi</a></span>(<span class="dt">max_norm =</span> <span class="dv">3</span>, <span class="dt">norm_type =</span> <span class="st">"1"</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt; 12 interacting positions.</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt;   rx     ry</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt;    1      0</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt;    2      0</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;    3      0</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt;    -2      1</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt;    -1      1  ... and 7 more.</span></a></code></pre></div>
</div>
<div id="parameter-restriction-families" class="section level2">
<h2 class="hasAnchor">
<a href="#parameter-restriction-families" class="anchor"></a>Parameter restriction families</h2>
<div id="family-onepar" class="section level3">
<h3 class="hasAnchor">
<a href="#family-onepar" class="anchor"></a>family <code>'onepar'</code>
</h3>
<p>The interaction depends only if the pair of values is equal or different and not on their values or relative position. Since we set <span class="math inline">\(\theta_{0,0,r} = 0\)</span>, this simplifies as:</p>
<p><span class="math display">\[ \theta_{a,b,r} = \theta \mathbb{1}_{[a \neq b]} \]</span></p>
<p>Example of valid array for <code>'onepar'</code>:</p>
<pre><code>#&gt; , , 1
#&gt; 
#&gt;       0     1     2
#&gt; 0  0.00 -0.01 -0.01
#&gt; 1 -0.01  0.00 -0.01
#&gt; 2 -0.01 -0.01  0.00
#&gt; 
#&gt; , , 2
#&gt; 
#&gt;       0     1     2
#&gt; 0  0.00 -0.01 -0.01
#&gt; 1 -0.01  0.00 -0.01
#&gt; 2 -0.01 -0.01  0.00</code></pre>
</div>
<div id="family-oneeach" class="section level3">
<h3 class="hasAnchor">
<a href="#family-oneeach" class="anchor"></a>family <code>'oneeach'</code>
</h3>
<p>The same as <code>'onepar'</code>, but allowing different values for different relative positions <span class="math inline">\(r\)</span>, resulting a total of <span class="math inline">\(|\mathcal{R}|\)</span> free parameters:</p>
<p><span class="math display">\[ \theta_{a,b,r} = \theta_r \mathbb{1}_{[a \neq b]} \]</span></p>
<p>Example of valid array for <code>'oneeach'</code>:</p>
<pre><code>#&gt; , , 1
#&gt; 
#&gt;       0     1     2
#&gt; 0  0.00 -0.01 -0.01
#&gt; 1 -0.01  0.00 -0.01
#&gt; 2 -0.01 -0.01  0.00
#&gt; 
#&gt; , , 2
#&gt; 
#&gt;       0     1     2
#&gt; 0  0.00 -0.02 -0.02
#&gt; 1 -0.02  0.00 -0.02
#&gt; 2 -0.02 -0.02  0.00</code></pre>
</div>
<div id="family-absdif" class="section level3">
<h3 class="hasAnchor">
<a href="#family-absdif" class="anchor"></a>family <code>'absdif'</code>
</h3>
<p>The values with equal absolute differences (<span class="math inline">\(|b-a|\)</span>) are kept constant within each relative position, resulting a total of <span class="math inline">\(|\mathcal{R}| \cdot C\)</span> free parameters. Note that the restriction <span class="math inline">\(\theta_{0,0,r} = 0\)</span> implies all pairs with absolute difference equals <span class="math inline">\(0\)</span> will also be null.</p>
<p><span class="math display">\[ \theta_{a,b,r} = \theta_{|b-a|,r} \]</span></p>
<p>Example of valid array for <code>'absdif'</code>:</p>
<pre><code>#&gt; , , 1
#&gt; 
#&gt;       0     1     2
#&gt; 0  0.00 -0.01 -0.02
#&gt; 1 -0.01  0.00 -0.01
#&gt; 2 -0.02 -0.01  0.00
#&gt; 
#&gt; , , 2
#&gt; 
#&gt;       0     1     2
#&gt; 0  0.00 -0.03 -0.04
#&gt; 1 -0.03  0.00 -0.03
#&gt; 2 -0.04 -0.03  0.00</code></pre>
</div>
<div id="family-dif" class="section level3">
<h3 class="hasAnchor">
<a href="#family-dif" class="anchor"></a>family <code>'dif'</code>
</h3>
<p>The same as <code>'absdif'</code>, but allowing different values for positive and negative differences, i.e., <span class="math inline">\(\theta_{a,b,r} \neq \theta_{b,a,r}\)</span> for <span class="math inline">\(a \neq b\)</span>. This restriction allows different effects on opposing directions to exist and there are <span class="math inline">\(|\mathcal{R}| \cdot 2C\)</span></p>
<p>Note that <code>'dif'</code> and <code>'absdif'</code> are typically used when the observed values actually have a quantitative meaning (as the gray levels of images), but not in tasks like image segmentation, where the value describes a class where, usually, the order and therefore differences have no meaning.</p>
<p><span class="math display">\[ \theta_{a,b,r} = \theta_{b-a,r}\]</span></p>
<p>Example of valid array for <code>'dif'</code>:</p>
<pre><code>#&gt; , , 1
#&gt; 
#&gt;       0     1     2
#&gt; 0  0.00 -0.03 -0.04
#&gt; 1 -0.02  0.00 -0.03
#&gt; 2 -0.01 -0.02  0.00
#&gt; 
#&gt; , , 2
#&gt; 
#&gt;       0     1     2
#&gt; 0  0.00 -0.07 -0.08
#&gt; 1 -0.06  0.00 -0.07
#&gt; 2 -0.05 -0.06  0.00</code></pre>
</div>
<div id="family-free" class="section level3">
<h3 class="hasAnchor">
<a href="#family-free" class="anchor"></a>family <code>'free'</code>
</h3>
<p>No additional restriction but the identifiability constraint <span class="math inline">\(\theta_{0,0,r} = 0\)</span> is still necessary. <span class="math inline">\(|\mathcal{R}| \cdot \left( C^2 + 2C \right)\)</span> free parameters.</p>
<p>Example of valid array for <code>'free'</code>:</p>
<pre><code>#&gt; , , 1
#&gt; 
#&gt;       0     1     2
#&gt; 0  0.00 -0.03 -0.06
#&gt; 1 -0.01 -0.04 -0.07
#&gt; 2 -0.02 -0.05 -0.08
#&gt; 
#&gt; , , 2
#&gt; 
#&gt;       0     1     2
#&gt; 0  0.00 -0.11 -0.14
#&gt; 1 -0.09 -0.12 -0.15
#&gt; 2 -0.10 -0.13 -0.16</code></pre>
</div>
</div>
</div>
<div id="parameter-estimation-on-markov-random-fields" class="section level1">
<h1 class="hasAnchor">
<a href="#parameter-estimation-on-markov-random-fields" class="anchor"></a>Parameter estimation on Markov Random Fields</h1>
<div id="pseudolikelihood" class="section level2">
<h2 class="hasAnchor">
<a href="#pseudolikelihood" class="anchor"></a>Pseudolikelihood</h2>
<p>The concept of pseudolikelihood was introduced in <span class="citation">Besag (1975)</span> and consists of using the product of conditional probabilities instead of the joint probability. The pseudolikelihood function <span class="math inline">\(PL()\)</span> is defined as</p>
<p><span class="math display">\[ PL(\theta;\mathbf{z}) = \prod_{i \in \mathcal{L}} P(Z_i = z_i | \mathbf{Z}_{\mathcal{N}_i} = \mathbf{z}_{\mathcal{N}_i}).\]</span></p>
<p>In the lattice model defined, this is described by</p>
<p><span class="math display">\[ PL(\theta;\mathbf{z}) = \prod_{i \in \mathcal{L}} \frac{\exp{\left( \sum_{r \in \mathcal{R}} \theta_{z_i, z_{i+r},r} + \theta_{z_{i-r}, z_i,r}  \right)}}{\sum_{a = 0}^C\exp{\left( \sum_{r \in \mathcal{R}} \theta_{a, z_{i+r},r} + \theta_{z_{i-r}, a,r}  \right)}},\]</span> with <span class="math inline">\(\theta_{z_i,z_j,a} = 0\)</span> if either <span class="math inline">\(i\)</span> or <span class="math inline">\(j\)</span> is out of bounds (i.e. when <span class="math inline">\(i+c \not \in \mathcal{L}\)</span>). This restriction keeps the expression above well-defined for pixels on the borders of <span class="math inline">\(\mathcal{L}\)</span>.</p>
<p><code>mrf2d</code>’d function <code><a href="../reference/pl_mrf2d.html">pl_mrf2d()</a></code> computes the (log-scale) pseudolikelihood function for a given observed lattice <span class="math inline">\(\mathbf{z}\)</span>, <span class="math inline">\(\theta\)</span> and interaction structure.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="../reference/pl_mrf2d.html">pl_mrf2d</a></span>(<span class="dt">Z =</span> Z_potts, <span class="dt">mrfi =</span> <span class="kw"><a href="../reference/mrfi.html">mrfi</a></span>(<span class="dv">1</span>), <span class="dt">theta =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/array">array</a></span>(<span class="dv">0</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#&gt; [1] -24718.78</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="kw"><a href="../reference/pl_mrf2d.html">pl_mrf2d</a></span>(<span class="dt">Z =</span> Z_potts, <span class="dt">mrfi =</span> <span class="kw"><a href="../reference/mrfi.html">mrfi</a></span>(<span class="dv">1</span>), <span class="dt">theta =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/array">array</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/diag">diag</a></span>(<span class="dv">3</span>) <span class="dv">-1</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt; [1] -10708.08</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="kw"><a href="../reference/pl_mrf2d.html">pl_mrf2d</a></span>(<span class="dt">Z =</span> Z_potts, <span class="dt">mrfi =</span> <span class="kw"><a href="../reference/mrfi.html">mrfi</a></span>(<span class="dv">1</span>), <span class="dt">theta =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/array">array</a></span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/diag">diag</a></span>(<span class="dv">3</span>), <span class="dt">dim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&gt; [1] -75849.79</span></a></code></pre></div>
<p>Parameter estimation can be performed, therefore, by maximizing the pseudolikelihood function. Maximum Pseudolikelihood Estimators (MPLEs) are comparable to Maximum Likelihood Estimators (MLEs) when the dependence is not too strong and can be computed in <code>mrf2d</code> with the function <code><a href="../reference/fit_pl.html">fit_pl()</a></code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="../reference/fit_pl.html">fit_pl</a></span>(Z_potts, <span class="kw"><a href="../reference/mrfi.html">mrfi</a></span>(<span class="dv">1</span>), <span class="dt">family =</span> <span class="st">"onepar"</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#&gt; $theta</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt;            0          1          2</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; 0  0.0000000 -0.9906675 -0.9906675</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt; 1 -0.9906675  0.0000000 -0.9906675</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt; 2 -0.9906675 -0.9906675  0.0000000</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">#&gt;            0          1          2</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">#&gt; 0  0.0000000 -0.9906675 -0.9906675</span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#&gt; 1 -0.9906675  0.0000000 -0.9906675</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">#&gt; 2 -0.9906675 -0.9906675  0.0000000</span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="co">#&gt; $value</span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="co">#&gt; [1] -10707.56</span></a>
<a class="sourceLine" id="cb14-20" data-line-number="20"></a>
<a class="sourceLine" id="cb14-21" data-line-number="21"><span class="kw"><a href="../reference/fit_pl.html">fit_pl</a></span>(Z_potts, <span class="kw"><a href="../reference/mrfi.html">mrfi</a></span>(<span class="dv">1</span>), <span class="dt">family =</span> <span class="st">"oneeach"</span>)</a>
<a class="sourceLine" id="cb14-22" data-line-number="22"><span class="co">#&gt; $theta</span></a>
<a class="sourceLine" id="cb14-23" data-line-number="23"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb14-24" data-line-number="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-25" data-line-number="25"><span class="co">#&gt;            0          1          2</span></a>
<a class="sourceLine" id="cb14-26" data-line-number="26"><span class="co">#&gt; 0  0.0000000 -0.9635956 -0.9635956</span></a>
<a class="sourceLine" id="cb14-27" data-line-number="27"><span class="co">#&gt; 1 -0.9635956  0.0000000 -0.9635956</span></a>
<a class="sourceLine" id="cb14-28" data-line-number="28"><span class="co">#&gt; 2 -0.9635956 -0.9635956  0.0000000</span></a>
<a class="sourceLine" id="cb14-29" data-line-number="29"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-30" data-line-number="30"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb14-31" data-line-number="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-32" data-line-number="32"><span class="co">#&gt;           0         1         2</span></a>
<a class="sourceLine" id="cb14-33" data-line-number="33"><span class="co">#&gt; 0  0.000000 -1.017917 -1.017917</span></a>
<a class="sourceLine" id="cb14-34" data-line-number="34"><span class="co">#&gt; 1 -1.017917  0.000000 -1.017917</span></a>
<a class="sourceLine" id="cb14-35" data-line-number="35"><span class="co">#&gt; 2 -1.017917 -1.017917  0.000000</span></a>
<a class="sourceLine" id="cb14-36" data-line-number="36"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-37" data-line-number="37"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-38" data-line-number="38"><span class="co">#&gt; $value</span></a>
<a class="sourceLine" id="cb14-39" data-line-number="39"><span class="co">#&gt; [1] -10705.05</span></a></code></pre></div>
</div>
<div id="stochastic-approximation" class="section level2">
<h2 class="hasAnchor">
<a href="#stochastic-approximation" class="anchor"></a>Stochastic Approximation</h2>
<p>Stochastic Approximation is an algorithm for finding a (concave) function’s maximum value without the need to evaluate it. Instead, it iteratively moves a solution in the gradient’s direction</p>
<p>The likelihood function of the MRF defined above belongs to the exponential family and can be written as</p>
<p><span class="math display">\[ l(\theta;\mathbf{z}^0) = (S(\mathbf{z}^0) \bullet \theta) -  \log(\zeta_\theta),\]</span> where <span class="math inline">\(\bullet\)</span> denotes the dot product and <span class="math inline">\(S(\mathbf{z})\)</span> is the vector sufficient statistics. Therefore, the global maximum is the point where the gradient <span class="math inline">\(\frac{\partial}{\partial \theta} l(\theta;\mathbf{z}^0)\)</span> is equal to zero, and the gradient is given by <span class="math display">\[\frac{\partial}{\partial \theta} l(\theta;\mathbf{z}^0) = S(\mathbf{z}^0) - \mathbb{E}_\theta(S(\mathbf{Z})).\]</span></p>
<p>Starting from an arbitrary configuration <span class="math inline">\(\theta^{(1)}\)</span>, which is considered the null vector by default in <code>mrf2d</code>, the algorithm iteratively samples a field <span class="math inline">\(\mathbf{z}^{(t)}\)</span> from the current parameter configuration <span class="math inline">\(\theta^{(t)}\)</span> and then updates <span class="math inline">\(\theta^{(t+1)}\)</span> according to an estimated gradient direction in the following recursion <span class="math display">\[ \theta^{(t+1)} = \theta^{(t)} + \gamma^{(t)} \left( S(\mathbf{z}^0) - S(\mathbf{z}^{(t)}) \right).\]</span></p>
<p>Some notes and details about <code>mrf2d</code>’s implementation of the Stochastic Approximation algorithm (function <code><a href="../reference/fit_sa.html">fit_sa()</a></code>):</p>
<ul>
<li>Exact sampling from a MRF either has a high computational cost or is an intractable problem, therefore, iterative methods (here, the Gibbs Sampler) are used. Since these methods may take a large number of cycles to reach the equilibrium distribution, the last sampled field is cached and used as an initial value for the next sample, with a smaller number of cycles between interactions. This was used for example in <span class="citation">Gimel’farb (1996)</span>.</li>
<li>Two additional parameters are used in our implementation: <code>refresh_each</code> and <code>refresh_cycles</code>. If specified, the sampled field <span class="math inline">\(\mathbf{z}^t\)</span> will be completely reset each <code>refresh_each</code> iterations. Whenever the field is reset, a new one will be sampled from a random initial configuration and a number of cycles equals to <code>refresh_cycles</code>, which should typically be a large value. Extreme cases are <code>refresh_each = 1</code>, where a completely new field is generated in each iteration (very slow) and <code>refresh_each</code> larger than the number of iterations (function’s defaults), which means no refresh will ever happen.</li>
<li>The algorithm requires the theoretical restrictions <span class="math inline">\(\sum_t \gamma^{(t)} = +\infty\)</span> and <span class="math inline">\(\sum_t \left(\gamma^{(t)}\right)^2 &lt; +\infty\)</span>. Since in practice only a finite number of iterations is executed, the choice of the <span class="math inline">\(\gamma^{(t)}\)</span> sequence requires some tuning to improve the results obtained.</li>
<li>The sequence <span class="math inline">\(\gamma^{(t)}\)</span> is specified by the parameter <code>gamma_seq</code>, but the values are divided by <code><a href="https://www.rdocumentation.org/packages/base/topics/length">length(Z)</a></code>. This standardizes the notion of what is a “small” or “large” value for the step size regardless of the lattice dimensions.</li>
<li>A <code>data.frame</code> containing the distances <span class="math inline">\(|| \mathbf{z}^0 - \mathbf{z}^{(t)} ||^2_2\)</span> is returned in the <code>metrics</code> field. It can be used to monitor the convergence of the algorithm.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">sa_onepar &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fit_sa.html">fit_sa</a></span>(Z_potts, <span class="kw"><a href="../reference/mrfi.html">mrfi</a></span>(<span class="dv">1</span>), <span class="dt">family =</span> <span class="st">"onepar"</span>, </a>
<a class="sourceLine" id="cb15-3" data-line-number="3">                    <span class="dt">gamma_seq =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dt">length.out =</span> <span class="dv">200</span>))</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">sa_onepar<span class="op">$</span>theta</a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="co">#&gt;            0          1          2</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="co">#&gt; 0  0.0000000 -0.9909923 -0.9909923</span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="co">#&gt; 1 -0.9909923  0.0000000 -0.9909923</span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="co">#&gt; 2 -0.9909923 -0.9909923  0.0000000</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-14" data-line-number="14"><span class="co">#&gt;            0          1          2</span></a>
<a class="sourceLine" id="cb15-15" data-line-number="15"><span class="co">#&gt; 0  0.0000000 -0.9909923 -0.9909923</span></a>
<a class="sourceLine" id="cb15-16" data-line-number="16"><span class="co">#&gt; 1 -0.9909923  0.0000000 -0.9909923</span></a>
<a class="sourceLine" id="cb15-17" data-line-number="17"><span class="co">#&gt; 2 -0.9909923 -0.9909923  0.0000000</span></a>
<a class="sourceLine" id="cb15-18" data-line-number="18"></a>
<a class="sourceLine" id="cb15-19" data-line-number="19">sa_oneeach &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fit_sa.html">fit_sa</a></span>(Z_potts, <span class="kw"><a href="../reference/mrfi.html">mrfi</a></span>(<span class="dv">1</span>), <span class="dt">family =</span> <span class="st">"oneeach"</span>, </a>
<a class="sourceLine" id="cb15-20" data-line-number="20">                    <span class="dt">gamma_seq =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dt">length.out =</span> <span class="dv">200</span>))</a>
<a class="sourceLine" id="cb15-21" data-line-number="21">sa_oneeach<span class="op">$</span>theta</a>
<a class="sourceLine" id="cb15-22" data-line-number="22"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb15-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-24" data-line-number="24"><span class="co">#&gt;            0          1          2</span></a>
<a class="sourceLine" id="cb15-25" data-line-number="25"><span class="co">#&gt; 0  0.0000000 -0.9649173 -0.9649173</span></a>
<a class="sourceLine" id="cb15-26" data-line-number="26"><span class="co">#&gt; 1 -0.9649173  0.0000000 -0.9649173</span></a>
<a class="sourceLine" id="cb15-27" data-line-number="27"><span class="co">#&gt; 2 -0.9649173 -0.9649173  0.0000000</span></a>
<a class="sourceLine" id="cb15-28" data-line-number="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-29" data-line-number="29"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb15-30" data-line-number="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-31" data-line-number="31"><span class="co">#&gt;           0         1         2</span></a>
<a class="sourceLine" id="cb15-32" data-line-number="32"><span class="co">#&gt; 0  0.000000 -1.012101 -1.012101</span></a>
<a class="sourceLine" id="cb15-33" data-line-number="33"><span class="co">#&gt; 1 -1.012101  0.000000 -1.012101</span></a>
<a class="sourceLine" id="cb15-34" data-line-number="34"><span class="co">#&gt; 2 -1.012101 -1.012101  0.000000</span></a>
<a class="sourceLine" id="cb15-35" data-line-number="35"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(sa_oneeach<span class="op">$</span>metrics[<span class="dv">2</span><span class="op">:</span><span class="dv">200</span>,])</a></code></pre></div>
<p><img src="mrf2d_files/figure-html/fit_sa_examples-1.png" width="50%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="hidden-markov-random-fields" class="section level1">
<h1 class="hasAnchor">
<a href="#hidden-markov-random-fields" class="anchor"></a>Hidden Markov Random Fields</h1>
<div id="gaussian-mixtures" class="section level2">
<h2 class="hasAnchor">
<a href="#gaussian-mixtures" class="anchor"></a>Gaussian Mixtures</h2>
<p><span class="citation">Zhang, Brady, and Smith (2001)</span></p>
<p><span class="math display">\[ f(\mathbf{y}|\mathbf{Z} = \mathbf{z}) = \prod_{i \in \mathcal{L}} \frac{1}{\sqrt{2\pi \sigma^2}} \exp \left( - \frac{(y_i - \mu_{Z_i})^2}{2\sigma^2} \right) \]</span></p>
</div>
</div>
<div id="bibliography" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#bibliography" class="anchor"></a>Bibliography</h1>
<div id="refs" class="references">
<div id="ref-besag1975statistical">
<p>Besag, Julian. 1975. “Statistical Analysis of Non-Lattice Data.” <em>Journal of the Royal Statistical Society: Series D (the Statistician)</em> 24 (3). Wiley Online Library: 179–95.</p>
</div>
<div id="ref-gimel1996texture">
<p>Gimel’farb, Georgy L. 1996. “Texture Modeling by Multiple Pairwise Pixel Interactions.” <em>IEEE Transactions on Pattern Analysis and Machine Intelligence</em> 18 (11). IEEE: 1110–4.</p>
</div>
<div id="ref-wiki_pl">
<p>Wikipedia. 2019a. “Pseudolikelihood.” <a href="https://en.wikipedia.org/wiki/Pseudolikelihood">https://en.wikipedia.org/wiki/Pseudolikelihood</a>.</p>
</div>
<div id="ref-wiki_sa">
<p>———. 2019b. “Stochastic Approximation.” <a href="https://en.wikipedia.org/wiki/Stochastic_approximation">https://en.wikipedia.org/wiki/Stochastic_approximation</a>.</p>
</div>
<div id="ref-zhang2001segmentation">
<p>Zhang, Yongyue, Michael Brady, and Stephen Smith. 2001. “Segmentation of Brain Mr Images Through a Hidden Markov Random Field Model and the Expectation-Maximization Algorithm.” <em>IEEE Transactions on Medical Imaging</em> 20 (1). Ieee: 45–57.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#introduction">Introduction</a><ul class="nav nav-pills nav-stacked">
<li><a href="#a-general-introduction-to-markov-random-fields">A general introduction to Markov Random Fields</a></li>
      <li><a href="#a-spatially-stationary-mrf-model-for-2-dimensional-lattices">A spatially stationary MRF model for 2-dimensional lattices</a></li>
      <li><a href="#the-mrf2d-package">The <code>mrf2d</code> package</a></li>
      </ul>
</li>
      <li>
<a href="#the-mrfi-class-and-parameter-arrays">The <code>mrfi</code> class and parameter arrays</a><ul class="nav nav-pills nav-stacked">
<li><a href="#creating-mrfi-objects">Creating <code>mrfi</code> objects</a></li>
      <li><a href="#parameter-restriction-families">Parameter restriction families</a></li>
      </ul>
</li>
      <li>
<a href="#parameter-estimation-on-markov-random-fields">Parameter estimation on Markov Random Fields</a><ul class="nav nav-pills nav-stacked">
<li><a href="#pseudolikelihood">Pseudolikelihood</a></li>
      <li><a href="#stochastic-approximation">Stochastic Approximation</a></li>
      </ul>
</li>
      <li>
<a href="#hidden-markov-random-fields">Hidden Markov Random Fields</a><ul class="nav nav-pills nav-stacked">
<li><a href="#gaussian-mixtures">Gaussian Mixtures</a></li>
      </ul>
</li>
      <li><a href="#bibliography">Bibliography</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Victor Freguglia.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
