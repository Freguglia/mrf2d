<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>mrfi: MRF interaction structure — mrfi-class • mrf2d</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="mrfi: MRF interaction structure — mrfi-class" />
<meta property="og:description" content="The mrfi S4 class is a representation of the interaction
structure for a spatially-stationary Markov Random Field.
The function mrfi() provides an interface for creation
mrfi objects. A plot method is also available for visualization, as
well as conversion methods like as.list and operators like +.
mrfi() creates an object of class mrfi based on a distance
rule and optionally a list of relative positions. The argument max_norm and
norm_type can be used to automatically include all positions within a
&quot;range&quot; defined by the norm type chosen and distance using that norm.
A list of relative positions may also be included to specify sparse
interaction structures, for example. Alternatively, rpositions()
can be used to create a based exclusively on a list of relative positions.
Simple operations are provided to include (set union)
new interacting positions to a mrfi object with the '+' operator and
remove positions (set difference) with -. Individual positions can be
included/excluded using length-2 vectors in the right hand side. Union and
set difference of complete structures can also be computed by adding or
subtracting two mrfi objects.
These operations deal with opposite directions filtering to avoid redundancy
in the interaction structure." />
<meta property="og:image" content="https://freguglia.github.io/mrf2d/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mrf2d</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mrf2d-family.html">Parameter restriction families in mrf2d</a>
    </li>
    <li>
      <a href="../articles/three-dimensions-on-mrf2d.html">Working with 3d lattices in mrf2d</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Freguglia/mrf2d/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>mrfi: MRF interaction structure</h1>
    <small class="dont-index">Source: <a href='https://github.com/Freguglia/mrf2d/blob/master/R/mrfi_class.R'><code>R/mrfi_class.R</code></a>, <a href='https://github.com/Freguglia/mrf2d/blob/master/R/mrfi_methods.R'><code>R/mrfi_methods.R</code></a></small>
    <div class="hidden name"><code>mrfi-class.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>mrfi</code> S4 class is a representation of the interaction
structure for a spatially-stationary Markov Random Field.</p>
<p>The function <code>mrfi()</code> provides an interface for creation
<code>mrfi</code> objects. A <code>plot</code> method is also available for visualization, as
well as conversion methods like <code>as.list</code> and operators like <code><a href='https://rdrr.io/r/base/Arithmetic.html'>+</a></code>.</p>
<p><code>mrfi()</code> creates an object of class <code>mrfi</code> based on a distance
rule and optionally a list of relative positions. The argument <code>max_norm</code> and
<code>norm_type</code> can be used to automatically include all positions within a
"range" defined by the norm type chosen and distance using that norm.</p>
<p>A list of relative positions may also be included to specify sparse
interaction structures, for example. Alternatively, <code>rpositions()</code>
can be used to create a based exclusively on a list of relative positions.</p>
<p>Simple operations are provided to include (set union)
new interacting positions to a <code>mrfi</code> object with the <code>'+'</code> operator and
remove positions (set difference) with <code><a href='https://rdrr.io/r/base/Arithmetic.html'>-</a></code>. Individual positions can be
included/excluded using length-2 vectors in the right hand side. Union and
set difference of complete structures can also be computed by adding or
subtracting two <code>mrfi</code> objects.</p>
<p>These operations deal with opposite directions filtering to avoid redundancy
in the interaction structure.</p>
    </div>

    <pre class="usage">mrfi(max_norm = 1, norm_type = "1", positions = NULL)

rpositions(positions)

# S3 method for mrfi
as.list(x, ...)

# S4 method for mrfi
length(x)

# S4 method for mrfi,numeric,missing
[[(x, i)

# S4 method for mrfi,numeric,missing
[(x, i)

# S4 method for mrfi,numeric
+(e1, e2)

# S4 method for mrfi,numeric
-(e1, e2)

# S4 method for mrfi,mrfi
+(e1, e2)

# S4 method for mrfi,mrfi
-(e1, e2)

mrfi_to_string(mrfi)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>max_norm</th>
      <td><p>a <code>numeric</code> value. All points with norm \(\le\) <code>max_dist</code>
are included.</p></td>
    </tr>
    <tr>
      <th>norm_type</th>
      <td><p>a <code>character</code> indicating the norm type used. Possible values
are "m", "1", "2", etc. See <code><a href='https://rdrr.io/r/base/norm.html'>norm</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>positions</th>
      <td><p>a <code>list</code> of <code>numeric</code> vectors of length 2. Each vector
corresponds to a relative position included.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p><code>mrfi</code> object.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments not used by this method.</p></td>
    </tr>
    <tr>
      <th>i</th>
      <td><p>vector of indexes to extract interacting positions.</p></td>
    </tr>
    <tr>
      <th>e1, mrfi</th>
      <td><p>A <code>mrfi</code> object.</p></td>
    </tr>
    <tr>
      <th>e2</th>
      <td><p>Either a second <code>mrfi</code> object or a length 2 <code>numeric</code> with the new
relative position to include (<code><a href='https://rdrr.io/r/base/Arithmetic.html'>+</a></code>) or remove (<code><a href='https://rdrr.io/r/base/Arithmetic.html'>-</a></code>).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>mrfi</code> object.</p>
<p><code><a href='https://rdrr.io/r/base/list.html'>as.list()</a></code>: converts the <code>mrfi</code> object to a list of interacting
positions (list of length-2 vectors).</p>
<p><code><a href='https://rdrr.io/r/base/Extract.html'>[[</a></code>: converts to list and subsets it.</p>
<p><code><a href='https://rdrr.io/r/base/Extract.html'>[</a></code>: subsets the <code>mrfi</code> object and returns another <code>mrfi</code> object.</p>
<p><code><a href='https://rdrr.io/r/base/Arithmetic.html'>+</a></code>: computes the union of the interaction structure in a <code>mrfi</code> object with
a <code>numeric</code> representing an additional position to include or another <code>mrfi</code>
object.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The interaction structure is defined by the list of relative
positions in it. For a specific pixel, conditional to the values of pixels in
these relative positions from it, its value is independent of any other pixel
in the image.</p>
<p>The relative positions are indentified by two integers <code>rx</code> and <code>ry</code>
representing the "shift" in the <code>x</code>-axis and <code>y</code>-axis respectively. As an
example: The relative position <code>(1,0)</code> representes the pixel in the immediate
right position, while <code>(-1,0)</code> the left one.</p>
<p>Note that the inclusion of a relative position to the dependence also implies
its opposite direction is not conditionally independent (commutativeness of
dependence), but only one is included in the <code>mrfi</code> object.</p>
<p>To illustrate that, a nearest neighbor dependence structure can be specified
by:</p>
<p><code>mrfi(1)</code></p>
<p>Note that it only includes the positions <code>(1,0)</code> and <code>(0,1)</code>, but when
visualizing it, for example, <code>mrf2d</code> understands the opposite directions
are also conditionally dependent, as in</p>
<p><code><a href='https://rdrr.io/r/graphics/plot.default.html'>plot(mrfi(1))</a></code>.</p>
    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    

<dl>
<dt><code>Rmat</code></dt><dd><p>A 2-column <code>matrix</code> where each row represents a relative position
of interaction.</p></dd>

</dl>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>If a position in <code>positions</code> is already included due to the
<code>max_norm</code> and <code>norm_type</code> specification, the second ocurrence is ignored.
The same is valid for repeated or opposite positions in <code>positions</code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>A paper with detailed description of the package can be found at
<a href='https://arxiv.org/abs/2006.00383'>https://arxiv.org/abs/2006.00383</a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>mrfi</span><span class='op'>(</span>max_norm <span class='op'>=</span> <span class='fl'>2</span>, norm_type <span class='op'>=</span> <span class='st'>"1"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='mrfi-class-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>mrfi</span><span class='op'>(</span>max_norm <span class='op'>=</span> <span class='fl'>2</span>, norm_type <span class='op'>=</span> <span class='st'>"m"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='mrfi-class-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>mrfi</span><span class='op'>(</span>max_norm <span class='op'>=</span> <span class='fl'>2</span>, norm_type <span class='op'>=</span> <span class='st'>"1"</span>, positions <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>,<span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='mrfi-class-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/list.html'>as.list</a></span><span class='op'>(</span><span class='fu'>mrfi</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [[1]]
#&gt; [1] 1 0
#&gt; 
#&gt; [[2]]
#&gt; [1] 0 1
#&gt; </div><div class='input'><span class='fu'>mrfi</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>
</div><div class='output co'>#&gt; [[1]]
#&gt; [1] 1 0
#&gt; </div><div class='input'><span class='fu'>mrfi</span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span>
</div><div class='output co'>#&gt; [[1]]
#&gt; [1] 1 0
#&gt; 
#&gt; [[2]]
#&gt; [1] 2 0
#&gt; 
#&gt; [[3]]
#&gt; [1] -1  1
#&gt; </div><div class='input'>
<span class='fu'>mrfi</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 2 interacting positions.
#&gt;   rx     ry
#&gt;    1      0
#&gt;    0      1</div><div class='input'><span class='fu'>rpositions</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 2 interacting positions.
#&gt;   rx     ry
#&gt;    1      0
#&gt;    0      1</div><div class='input'><span class='fu'>mrfi</span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 6 interacting positions.
#&gt;   rx     ry
#&gt;    1      0
#&gt;    2      0
#&gt;    -1      1
#&gt;    0      1
#&gt;    1      1  ... and 1 more.</div><div class='input'><span class='fu'>mrfi</span><span class='op'>(</span><span class='fl'>2</span>, norm_type <span class='op'>=</span> <span class='st'>"m"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 12 interacting positions.
#&gt;   rx     ry
#&gt;    1      0
#&gt;    2      0
#&gt;    -2      1
#&gt;    -1      1
#&gt;    0      1  ... and 7 more.</div><div class='input'><span class='fu'>mrfi</span><span class='op'>(</span><span class='fl'>1</span>, positions <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>,<span class='fl'>4</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>4</span>,<span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 4 interacting positions.
#&gt;   rx     ry
#&gt;    1      0
#&gt;    0      1
#&gt;    4      4
#&gt;    -4      4</div><div class='input'>

<span class='co'>#Repeated positions are handled automatically</span>
<span class='fu'>mrfi</span><span class='op'>(</span><span class='fl'>1</span>, positions <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 3 interacting positions.
#&gt;   rx     ry
#&gt;    1      0
#&gt;    0      1
#&gt;    2      0</div><div class='input'>
<span class='fu'>mrfi</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>0</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 3 interacting positions.
#&gt;   rx     ry
#&gt;    1      0
#&gt;    0      1
#&gt;    2      0</div><div class='input'><span class='fu'>mrfi</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 1 interacting positions.
#&gt;   rx     ry
#&gt;    0      1</div><div class='input'><span class='fu'>mrfi</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>mrfi</span><span class='op'>(</span><span class='fl'>0</span>, positions <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 3 interacting positions.
#&gt;   rx     ry
#&gt;    1      0
#&gt;    0      1
#&gt;    2      0</div><div class='input'><span class='fu'>mrfi</span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>-</span> <span class='fu'>mrfi</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 4 interacting positions.
#&gt;   rx     ry
#&gt;    2      0
#&gt;    -1      1
#&gt;    1      1
#&gt;    0      2</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Victor Freguglia.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


